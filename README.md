# 高壓模擬實驗觀測系統申請表

一個以瀏覽器執行的六階段分頁式申請表，支援受測物管理、壓力測試流程規劃、時序圖自動繪製、接線要求設定、價格試算與 Word 檔輸出。

## 特色總覽
- 六階段清晰流程與頂部導覽快速跳轉
- 動態受測物（可新增/移除、照片上傳、入水狀態）
- 壓力測試步驟：增壓/持壓/降壓，可動態新增/移除
- 自動生成描述文字與即時時序圖（Canvas）
- 接線要求：兩套系統擇一，(1)(2) 預設鎖定並帶值，其餘按需勾選
- 價格試算：依總測試時間與壓力級距計價，含額外服務
- 一鍵輸出 Word（含時序圖圖片、表格、正式樣式）

## 網頁六階段
1. 注意事項
   - 條列安全規範、受測物條件、測試參數（新增：升降壓速率可能受受測物影響，實際以現場調控為主）等內容。
2. 委託單位資料
   - 單位名稱、統一編號、地址、聯絡人、聯絡電話、E-mail。
3. 受測物資料（可多筆）
   - 受測物名稱、數量、尺寸、受測物照片、入水狀態（下沉/上浮）、備註。
4. 壓力測試要求（含時序圖）
   - 步驟類型：增壓 / 持壓 / 降壓。
   - 目標壓力（bar）。
   - 速率/持壓時間：
     - 增壓速率下拉：0.05 ~ 0.45 bar/min（步進 0.05）。
     - 降壓速率下拉：0.05 ~ 2.00 bar/min（步進 0.05）。
     - 持壓時間（min）。
   - 新增步驟時會「預填上一步驟的類型與參數」並立即刷新時序圖。
   - 自動生成描述（已移除增/降壓與持壓的 ±0.5 bar 文案）。
   - 時序圖：無資料點標示、灰色內格線、黑色外框，X/Y 軸標題為「時間 (min)」「壓力 (bar)」。
5. 接線要求
   - 先選系統（HPT-450-230L 或 HPT-800-85L，二擇一，450 為預設）。
   - (1)(2) 兩孔預先勾選鎖定且帶值：
     - 7/16-20UNF → MCBH6M / 照明燈
     - 1/2-20UNF → DBH8F / 攝影機
   - 其餘孔位以勾選方式展開兩欄輸入：「接頭零件規格」「備註」。
   - 備註欄視覺寬度為規格欄的 2 倍（在寬螢幕下特別明顯）。
6. 價格試算
   - 依第 4 階段計算總測試時間（以分鐘計算避免浮點誤差）。
   - 基本費用與超時費用階梯計價（min→hour 換算時以正確四捨五入處理）。
   - 額外服務：英文報告、錄影服務。
   - 頁面底部附註：「以上價格為試算價格，實際價格以最終報價為準。」

## 重要規格與行為
- 單位標準化：時間以 min、壓力以 bar 顯示。
- 新增步驟：預帶前一步參數並即時刷新時序圖。
- 自動更新時序圖：修改任何步驟欄位、增刪步驟、或切回第 4 階段時都會更新。
- 速率/時間的核心計算以「分鐘」為基準，避免浮點誤差。

## Word 文件輸出
- 文件標題：高壓模擬實驗觀測系統申請表。
- 字體：全文件使用「微軟正黑體」。
- 字級：
  - 主標題 20pt
  - 章節標題（一～六）16pt
  - 次標題（如「受測物 1」「測試參數」「價格計算」）14pt
  - 內文與表格文字 12pt
- 表格：所有表格欄位置中；第一欄/第二欄寬度為 25% / 75%。
- 內容包含：委託單位、受測物（含照片）、壓力測試描述、時序圖（以 Canvas 轉圖內嵌）、接線要求明細、價格計算與總計。
- 接線要求章節：移除「選用系統規格說明」敘述，只保留系統接線明細。
- 文末加註（與頁面一致）：以上價格為試算價格，實際價格以最終報價為準。

## 使用方式
1. 以瀏覽器開啟 `index.html`。
2. 依序完成各階段資料。
3. 第 4 階段設定步驟後，時序圖會自動刷新；新增步驟會帶入上一筆參數。
4. 第 6 階段確認價格試算與選擇額外服務。
5. 點擊「生成文件」下載 Word 檔。

## 檔案結構
```
高壓艙申請單/
├── index.html    # 主頁面（六階段表單、結構）
├── styles.css    # 樣式（導覽、時序圖、受測物、接線、價格試算等）
├── script.js     # 行為（動態步驟、時序圖、Word 匯出、價格計算）
└── README.md     # 本說明文件
```

## 開發重點
- 自動更新流程：`updateStepRate/Pressure/HoldTime/Type`、`addTestStep/removeTestStep`、`updateTestSteps()` 最後均會觸發 `autoUpdateTimeline()`。
- 新增步驟預填：`addTestStep()` 會帶入上一個步驟的類型與參數並即時更新。
- 速率選單：在 `createTestStepElement()` 內根據類型產生對應下拉。
- Word 匯出：使用 `docx` 產生文件，圖片以 Canvas 轉成圖片後嵌入。

## 相容性建議
- 以 Chromium 系瀏覽器測試最佳（Chrome/Edge）。
- 若遇到圖片授權或字型缺漏，請於系統安裝相容字型（微軟正黑體）。

## 版權
此專案僅供內部或教學示範使用。
