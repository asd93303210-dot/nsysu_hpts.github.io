<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高壓模擬實驗觀測系統申請表</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>高壓模擬實驗觀測系統申請表</h1>
        </header>

        <!-- 頁面導航 -->
        <nav class="page-navigation">
            <div class="nav-item active" data-page="1">
                <span class="nav-number">1</span>
                <span class="nav-text">注意事項</span>
            </div>
            <div class="nav-item" data-page="2">
                <span class="nav-number">2</span>
                <span class="nav-text">委託單位資料</span>
            </div>
            <div class="nav-item" data-page="3">
                <span class="nav-number">3</span>
                <span class="nav-text">受測物資料</span>
            </div>
            <div class="nav-item" data-page="4">
                <span class="nav-number">4</span>
                <span class="nav-text">壓力測試要求</span>
            </div>
            <div class="nav-item" data-page="5">
                <span class="nav-number">5</span>
                <span class="nav-text">接線要求</span>
            </div>
            <div class="nav-item" data-page="6">
                <span class="nav-number">6</span>
                <span class="nav-text">價格試算</span>
            </div>
        </nav>

        <!-- 第一頁：注意事項 -->
        <div class="page active" id="page1">
            <section class="form-section">
                <h2>第一階段：注意事項</h2>
                <div class="notice-content">
                    <ol class="notice-list">
                        <li><strong>安全規範</strong>
                            <ul>
                                <li>測試期間請全程遵從現場人員指示。</li>
                                <li>未經允許不得靠近或操作任何設備。</li>
                            </ul>
                        </li>
                        <li><strong>受測物條件</strong>
                            <ul>
                                <li>請確認受測物結構完整、無漏水、破損、鬆脫等風險。</li>
                                <li>如需供電或特殊配件，請於第 5 階段「接線要求」裡先行確認。</li>
                            </ul>
                        </li>
                        <li><strong>測試參數</strong>
                            <ul>
                                <li>請於第 4 階段明確填寫增壓/降壓速率、持壓時間與目標壓力。</li>
                                <li>升降壓速率會因受測物影響其速率，實際速率以現場調控為主。</li>
                            </ul>
                        </li>
                        <li><strong>測試時程</strong>
                            <ul>
                                <li>實際時程將依現場設備排程與受測物狀況調整。</li>
                                <li>若需加時費用，將依價格試算標準另行計費。</li>
                            </ul>
                        </li>
                        <li><strong>資料產出</strong>
                            <ul>
                                <li>如勾選英文報告或錄影服務，將於測試完成後一併整理。</li>
                            </ul>
                        </li>
                        <li><strong>責任歸屬</strong>
                            <ul>
                                <li>測試過程中，若因受測物本身結構或密封缺陷造成損壞，非因人為疏失者，本單位不負賠償責任。</li>
                            </ul>
                        </li>
                        <li><strong>保密義務</strong>
                            <ul>
                                <li>若測試涉及機密資料，請先提出保密需求與範本，雙方簽署後始得進行。</li>
                            </ul>
                        </li>
                        <li><strong>報價與付款</strong>
                            <ul>
                                <li>第 6 階段金額僅供試算，正式報價以本單位報價單為準。</li>
                                <li>請於期限內完成款項繳納，將一併交付測試成果與正式單據。</li>
                            </ul>
                        </li>
                        <li><strong>聯絡窗口</strong>
                            <ul>
                                <li>如有特殊需求或變更，請即時與承辦人聯繫，以便協調測試安排與時程。</li>
                            </ul>
                        </li>
                    </ol>
                </div>
            </section>
        </div>

        <!-- 第二頁：委託單位資料 -->
        <div class="page" id="page2">
            <section class="form-section">
                <h2>第二階段：委託單位資料</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="companyName">單位名稱 *</label>
                        <input type="text" id="companyName" name="companyName" required>
                    </div>
                    <div class="form-group">
                        <label for="taxId">統一編號 *</label>
                        <input type="text" id="taxId" name="taxId" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="address">地址 *</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    <div class="form-group">
                        <label for="contactPerson">聯絡人 *</label>
                        <input type="text" id="contactPerson" name="contactPerson" required>
                    </div>
                    <div class="form-group">
                        <label for="contactPhone">聯絡電話 *</label>
                        <input type="tel" id="contactPhone" name="contactPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">E-mail *</label>
                        <input type="email" id="contactEmail" name="contactEmail" required>
                    </div>
                </div>
            </section>
        </div>

        <!-- 第三頁：受測物資料 -->
        <div class="page" id="page3">
            <section class="form-section">
                <h2>第三階段：受測物資料</h2>
                
                <div class="test-objects-section">
                    <div class="test-objects-header">
                        <h3>受測物清單</h3>
                    </div>
                    
                    <div id="testObjectsList" class="test-objects-list">
                        <!-- 受測物項目將在這裡動態生成 -->
                    </div>
                    
                    <div class="add-button-container">
                        <button type="button" id="addTestObject" class="btn btn-secondary">新增受測物</button>
                    </div>
                </div>
            </section>
        </div>

        <!-- 第四頁：壓力測試要求 -->
        <div class="page" id="page4">
            <section class="form-section">
                <h2>第四階段：壓力測試要求</h2>
                <div class="pressure-test-container">
                    <div class="test-sequence" id="testSequence">
                        <!-- 測試序列將在這裡動態生成 -->
                    </div>
                    <div class="add-button-container">
                        <button type="button" id="addTestStep" class="btn btn-secondary">新增測試步驟</button>
                    </div>
                </div>
                
                <!-- 時序圖生成區域 -->
                <div class="timeline-section">
                    <h3>測試時序圖</h3>
                    <p class="timeline-note">時序圖會根據測試步驟參數自動更新</p>
                    <div class="timeline-container" id="timelineContainer" style="display: none;">
                        <canvas id="timelineCanvas" width="800" height="400"></canvas>
                    </div>
                </div>
            </section>
        </div>

        <!-- 第五頁：接線要求 -->
        <div class="page" id="page5">
            <section class="form-section">
                <h2>第五階段：接線要求</h2>
                <div class="wiring-content">
                    <!-- 系統選擇 -->
                    <div class="system-selection">
                        <h3>請選擇要使用的高壓艙系統</h3>
                        <div class="system-radio-group">
                            <label class="system-radio-label">
                                <input type="radio" name="selectedSystem" value="450" id="system450" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-content">
                                    <h4>HPT-450-230L</h4>
                                    <p>最大操作壓力：450 bar</p>
                                    <p>艙體空間尺寸：Ø 460 mm × L 600 mm</p>
                                </div>
                            </label>
                            <label class="system-radio-label">
                                <input type="radio" name="selectedSystem" value="800" id="system800">
                                <span class="radio-custom"></span>
                                <div class="radio-content">
                                    <h4>HPT-800-85L</h4>
                                    <p>最大操作壓力：800 bar</p>
                                    <p>艙體空間尺寸：Ø 250 mm × L 800 mm</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- HPT-450-230L 系統選項 -->
                    <div class="system-section" id="system450Section" style="display: none;">
                        <h3>HPT-450-230L 系統</h3>
                        <div class="port-options">
                            <div class="port-option locked">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="1" data-spec="7/16-20UNF" data-description="" checked disabled>
                                    <span class="checkmark"></span>
                                    (1) 7/16-20UNF
                                </label>
                                <div class="input-group">
                                    <input type="text" class="component-input" value="MCBH6M" readonly>
                                    <input type="text" class="component-input" value="照明燈" readonly>
                                </div>
                            </div>
                            <div class="port-option locked">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="2" data-spec="1/2-20UNF" data-description="" checked disabled>
                                    <span class="checkmark"></span>
                                    (2) 1/2-20UNF
                                </label>
                                <div class="input-group">
                                    <input type="text" class="component-input" value="DBH8F" readonly>
                                    <input type="text" class="component-input" value="攝影機" readonly>
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="3" data-spec="7/16-20UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (3) 7/16-20UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="4" data-spec="7/16-20UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (4) 7/16-20UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="5" data-spec="7/16-20UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (5) 7/16-20UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="450" data-port="6" data-spec="1/2-20UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (6) 1/2-20UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- HPT-800-85L 系統選項 -->
                    <div class="system-section" id="system800Section" style="display: none;">
                        <h3>HPT-800-85L 系統</h3>
                        <div class="port-options">
                            <div class="port-option locked">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="800" data-port="1" data-spec="7/16-20UNF" data-description="" checked disabled>
                                    <span class="checkmark"></span>
                                    (1) 7/16-20UNF
                                </label>
                                <div class="input-group">
                                    <input type="text" class="component-input" value="MCBH6M" readonly>
                                    <input type="text" class="component-input" value="照明燈" readonly>
                                </div>
                            </div>
                            <div class="port-option locked">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="800" data-port="2" data-spec="1/2-20UNF" data-description="" checked disabled>
                                    <span class="checkmark"></span>
                                    (2) 1/2-20UNF
                                </label>
                                <div class="input-group">
                                    <input type="text" class="component-input" value="DBH8F" readonly>
                                    <input type="text" class="component-input" value="攝影機" readonly>
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="800" data-port="3" data-spec="5/8-18UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (3) 5/8-18UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                            <div class="port-option">
                                <label class="checkbox-label">
                                    <input type="checkbox" data-system="800" data-port="4" data-spec="5/8-18UNF" data-description="">
                                    <span class="checkmark"></span>
                                    (4) 5/8-18UNF
                                </label>
                                <div class="input-group" style="display: none;">
                                    <input type="text" class="component-input" placeholder="接頭零件規格">
                                    <input type="text" class="component-input" placeholder="備註">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 第六頁：價格試算 -->
        <div class="page" id="page6">
            <section class="form-section">
                <h2>第六階段：價格試算</h2>
                <div class="pricing-content">
                    <!-- 測試參數顯示 -->
                    <div class="test-params">
                        <h3>測試參數</h3>
                        <div class="params-grid">
                            <div class="param-item">
                                <label>最大測試壓力：</label>
                                <span id="maxPressure">-- bar</span>
                            </div>
                            <div class="param-item">
                                <label>總測試時間：</label>
                                <span id="totalTime">-- 小時</span>
                            </div>
                            <div class="param-item">
                                <label>選用系統：</label>
                                <span id="selectedSystemName">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- 價格計算結果 -->
                    <div class="price-calculation">
                        <h3>價格計算</h3>
                        <p class="price-note">說明：不足一小時以一小時計算，例如 2小時30分鐘 計 3小時。</p>
                        <div class="calculation-details">
                            <div class="base-fee">
                                <div class="fee-item">
                                    <span class="fee-label">基本費用 (3小時內)：</span>
                                    <span class="fee-amount" id="baseFee">NT$ 0</span>
                                </div>
                            </div>
                            
                            <div class="overtime-fee" id="overtimeSection" style="display: none;">
                                <div class="fee-item">
                                    <span class="fee-label">超時費用 (第4-8小時)：</span>
                                    <span class="fee-amount" id="overtimeFee">NT$ 0</span>
                                </div>
                                <div class="fee-item">
                                    <span class="fee-label">超時小時數：</span>
                                    <span class="fee-amount" id="overtimeHours">0 小時</span>
                                </div>
                            </div>

                            <div class="extended-overtime-fee" id="extendedOvertimeSection" style="display: none;">
                                <div class="fee-item">
                                    <span class="fee-label">延長超時費用 (第9小時起)：</span>
                                    <span class="fee-amount" id="extendedOvertimeFee">NT$ 0</span>
                                </div>
                                <div class="fee-item">
                                    <span class="fee-label">延長超時小時數：</span>
                                    <span class="fee-amount" id="extendedOvertimeHours">0 小時</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 額外服務選項 -->
                    <div class="additional-services">
                        <h3>額外服務</h3>
                        <div class="service-options">
                            <label class="service-option">
                                <input type="checkbox" id="englishReport">
                                <span class="service-checkmark"></span>
                                <div class="service-content">
                                    <h4>英文測試報告</h4>
                                    <p>額外收費 NT$ 12,000</p>
                                </div>
                            </label>
                            <label class="service-option">
                                <input type="checkbox" id="videoRecording">
                                <span class="service-checkmark"></span>
                                <div class="service-content">
                                    <h4>錄影服務</h4>
                                    <p>額外收費 標準費用的 5%</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- 總計 -->
                    <div class="total-summary">
                        <div class="total-breakdown">
                            <div class="total-item">
                                <span class="total-label">基本測試費用：</span>
                                <span class="total-amount" id="basicTestFee">NT$ 0</span>
                            </div>
                            <div class="total-item" id="englishReportFee" style="display: none;">
                                <span class="total-label">英文報告費用：</span>
                                <span class="total-amount">NT$ 12,000</span>
                            </div>
                            <div class="total-item" id="videoRecordingFee" style="display: none;">
                                <span class="total-label">錄影服務費用：</span>
                                <span class="total-amount" id="videoFeeAmount">NT$ 0</span>
                            </div>
                        </div>
                        <div class="final-total">
                            <span class="final-label">總計：</span>
                            <span class="final-amount" id="finalTotal">NT$ 0</span>
                        </div>
                        <p class="pricing-note" style="text-align: right;">以上價格為試算價格，實際價格以最終報價為準。</p>
                    </div>

                    <!-- 優惠說明 -->
                    <div class="discount-notice">
                        <p><strong>優惠說明：</strong>累計申請3次以上者可享有優惠價格，詳情請洽相關人員。</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- 表單控制按鈕 -->
        <div class="form-controls">
            <button type="button" id="prevBtn" class="btn btn-secondary">上一步</button>
            <button type="button" id="nextBtn" class="btn btn-primary">下一步</button>
            <button type="submit" id="submitBtn" class="btn btn-success" style="display: none;">生成文件</button>
        </div>
    </div>

    <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
    <script src="script.js"></script>
</body>
</html>
